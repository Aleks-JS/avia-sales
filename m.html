<html>

<head>


</head>

<body>
    <script>
        class Observer {
            callbacks = [];

            addSubsriber(callback) {
                this.callbacks.push(callback)
            }

            removeSubsriber(callback) {
                const index = this.callbacks.indexOf(callback)
                if (index !== -1) {
                    this.callbacks.splice(index, 1)
                }
            }

            notify(value) {
                this.callbacks.forEach((el) => {
                    el(value)
                })
            }
        }


        class State {
            obs = new Observer()

            constructor(value) {
                this.value = value;
            }

            setState(value) {
                this.value = value;
                this.obs.notify(this.value)
            }

            getValue() {
                return this.value
            }

            getObs() {
                return this.obs
            }
        }

        const state = new State()

        const createElement = (tag, state) => {
            const el = document.createElement(tag)
            const parent = document.createElement("p")

            state.obs.addSubsriber((value) => {
                el.textContent = value.name
            })
            parent.appendChild(el)
            return parent
        }

        document.body.appendChild(createElement("div", state))

        const input = document.createElement("input")

        document.body.appendChild(input)

        input.addEventListener('keyup', () => {
            state.setState({
                name: input.value || ""
            })
        })
    </script>
</body>

</html>